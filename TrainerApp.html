<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CRM Trainer.Ai — Тренер</title>

  <!-- Tailwind CSS через CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Font Awesome для иконок -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />

  <style>
    .scrollbar-hide::-webkit-scrollbar {
      display: none;
    }
    .scrollbar-hide {
      -ms-overflow-style: none;
      scrollbar-width: none;
    }
  </style>
</head>
<body class="bg-gray-100">
  <div id="root"></div>

  <!-- React / ReactDOM / Babel (для JSX в браузере) -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <script type="text/babel">
    const { useState, useRef } = React;

    // Обёртки-иконки под Font Awesome
    const Users = ({ className = "" }) => <i className={"fa-solid fa-users " + className}></i>;
    const BarChart3 = ({ className = "" }) => <i className={"fa-solid fa-chart-column " + className}></i>;
    const Settings = ({ className = "" }) => <i className={"fa-solid fa-gear " + className}></i>;
    const MessageCircle = ({ className = "" }) => <i className={"fa-solid fa-message " + className}></i>;
    const Send = ({ className = "" }) => <i className={"fa-solid fa-paper-plane " + className}></i>;
    const Plus = ({ className = "" }) => <i className={"fa-solid fa-plus " + className}></i>;
    const Check = ({ className = "" }) => <i className={"fa-solid fa-check " + className}></i>;
    const Phone = ({ className = "" }) => <i className={"fa-solid fa-phone " + className}></i>;
    const MessageSquare = ({ className = "" }) => <i className={"fa-solid fa-comment-dots " + className}></i>;
    const UserIcon = ({ className = "" }) => <i className={"fa-solid fa-user " + className}></i>;
    const TrendingUp = ({ className = "" }) => <i className={"fa-solid fa-arrow-trend-up " + className}></i>;
    const Coins = ({ className = "" }) => <i className={"fa-solid fa-coins " + className}></i>;
    const CalendarCheck = ({ className = "" }) => <i className={"fa-regular fa-calendar-check " + className}></i>;
    const Paperclip = ({ className = "" }) => <i className={"fa-solid fa-paperclip " + className}></i>;
    const LinkIcon = ({ className = "" }) => <i className={"fa-solid fa-link " + className}></i>;
    const Archive = ({ className = "" }) => <i className={"fa-solid fa-box-archive " + className}></i>;
    const Mail = ({ className = "" }) => <i className={"fa-regular fa-envelope " + className}></i>;
    const Eye = ({ className = "" }) => <i className={"fa-regular fa-eye " + className}></i>;
    const TrendingUpIcon = TrendingUp;
    const MoreVertical = ({ className = "" }) => <i className={"fa-solid fa-ellipsis-vertical " + className}></i>;
    const X = ({ className = "" }) => <i className={"fa-solid fa-xmark " + className}></i>;
    const MapPin = ({ className = "" }) => <i className={"fa-solid fa-location-dot " + className}></i>;
    const Watch = ({ className = "" }) => <i className={"fa-solid fa-stopwatch " + className}></i>;
    const Smartphone = ({ className = "" }) => <i className={"fa-solid fa-mobile-screen-button " + className}></i>;
    const Bot = ({ className = "" }) => <i className={"fa-solid fa-robot " + className}></i>;
    const Globe = ({ className = "" }) => <i className={"fa-solid fa-globe " + className}></i>;
    const Search = ({ className = "" }) => <i className={"fa-solid fa-magnifying-glass " + className}></i>;
    const MailIcon = Mail;

    const App = () => {
      const [activeTab, setActiveTab] = useState("dashboard");
      const [chatMessages, setChatMessages] = useState([
        {
          id: 1,
          sender: "agent",
          text: "Привет! У тебя есть клиенты, которым нужно напомнить об оплате.",
          actions: ["напомнить оплату"],
        },
        { id: 2, sender: "trainer", text: "Да, отправь мне список" },
        {
          id: 3,
          sender: "agent",
          text: "Вот клиенты с просрочкой:",
          actions: ["отправить клиенту"],
        },
      ]);
      const [chatInput, setChatInput] = useState("");
      const [selectedClient, setSelectedClient] = useState(null);
      const [clientDetailIndex, setClientDetailIndex] = useState(0); // 0 = Инфо, 1 = Активности
      const [crmSubTab, setCrmSubTab] = useState("clients");
      const [searchQuery, setSearchQuery] = useState("");
      const [statusFilter, setStatusFilter] = useState("Все");

      const touchStartX = useRef(0);
      const touchEndX = useRef(0);
      const clientTouchStartX = useRef(0);
      const clientTouchEndX = useRef(0);

      const clients = [
        {
          id: 1,
          name: "Константин Константинопольский",
          status: "Купил",
          lastContact: "1 день назад",
          overdue: false,
          unread: false,
          avatar: "https://placehold.co/40x40/FFD700/000000?text=%D0%9A",
          day: "Пн",
          location: "клуб",
          premium: true,
          phone: "+7 (999) 123-45-67",
          email: "konstantin@example.com",
          age: 32,
          purchasedProducts: ["Персональные тренировки", "Диета"],
          history: [
            { date: "2025-11-08", message: "Напоминание об оплате отправлено", sender: "агент" },
            { date: "2025-11-07", message: "Предложение о новом тарифе", sender: "тренер" },
          ],
          activity: { calories: 2200, steps: 8500, water: 2.5, workouts: 4, sleep: 7.2 },
        },
        {
          id: 2,
          name: "Марго Р.",
          status: "Демо",
          lastContact: "2 дня назад",
          overdue: false,
          unread: true,
          avatar: "https://placehold.co/40x40/FFD700/000000?text=M",
          day: "Пн",
          location: "онлайн",
          phone: "+7 (999) 123-45-68",
          email: "margo@example.com",
          age: 28,
          purchasedProducts: [],
          history: [{ date: "2025-11-06", message: "Демо-запись отправлена", sender: "тренер" }],
          activity: { calories: 1800, steps: 6200, water: 1.8, workouts: 2, sleep: 6.5 },
        },
        {
          id: 3,
          name: "Анна Петрова",
          status: "Купил",
          lastContact: "2 часа назад",
          overdue: false,
          premium: true,
          avatar: "https://placehold.co/40x40/FF69B4/FFFFFF?text=A",
          day: "Вт",
          location: "клуб",
          phone: "+7 (999) 123-45-69",
          email: "anna@example.com",
          age: 35,
          purchasedProducts: ["Персональные тренировки", "Диета", "Групповые занятия"],
          history: [
            { date: "2025-11-09", message: "Напоминание об оплате отправлено", sender: "агент" },
            { date: "2025-11-08", message: "Программа тренировок отправлена", sender: "тренер" },
          ],
          activity: { calories: 2400, steps: 10200, water: 3.0, workouts: 6, sleep: 8.0 },
        },
        {
          id: 4,
          name: "Иван Сидоров",
          status: "Думает",
          lastContact: "1 час назад",
          overdue: true,
          avatar: "https://placehold.co/40x40/4169E1/FFFFFF?text=%D0%98",
          day: "Ср",
          location: "воркаут",
          phone: "+7 (999) 123-45-70",
          email: "ivan@example.com",
          age: 29,
          purchasedProducts: [],
          history: [{ date: "2025-11-05", message: "Консультация по тренировкам", sender: "тренер" }],
          activity: { calories: 2000, steps: 7200, water: 2.0, workouts: 3, sleep: 6.8 },
        },
        {
          id: 5,
          name: "Мария Козлова",
          status: "Демо",
          lastContact: "5 часов назад",
          overdue: false,
          avatar: "https://placehold.co/40x40/32CD32/FFFFFF?text=%D0%9C",
          day: "Чт",
          location: "онлайн",
          phone: "+7 (999) 123-45-71",
          email: "maria@example.com",
          age: 26,
          purchasedProducts: [],
          history: [{ date: "2025-11-04", message: "Демо-запись отправлена", sender: "тренер" }],
          activity: { calories: 1700, steps: 5800, water: 1.5, workouts: 1, sleep: 6.0 },
        },
        {
          id: 6,
          name: "Дмитрий Волков",
          status: "Новый",
          lastContact: "3 дня назад",
          overdue: true,
          avatar: "https://placehold.co/40x40/FF4500/FFFFFF?text=%D0%94",
          day: "Пт",
          location: "клуб",
          phone: "+7 (999) 123-45-72",
          email: "dmitry@example.com",
          age: 31,
          purchasedProducts: [],
          history: [{ date: "2025-11-03", message: "Регистрация нового клиента", sender: "система" }],
          activity: { calories: 1900, steps: 6800, water: 2.2, workouts: 2, sleep: 7.0 },
        },
      ];

      const tasks = [
        { id: 1, text: "Напомнить Марго о записи", client: "Марго Р.", date: "2025-11-09", overdue: false },
        { id: 2, text: "Напомнить Анне об оплате", client: "Анна Петрова", date: "2025-11-08", overdue: true },
        { id: 3, text: "Отправить программу Ивану", client: "Иван Сидоров", date: "2025-11-09", overdue: false },
        { id: 4, text: "Позвонить Марии для подтверждения", client: "Мария Козлова", date: "2025-11-10", overdue: false },
      ];

      const products = [
        { id: 1, name: "Персональные тренировки", price: "5000 руб" },
        { id: 2, name: "План питания", price: "2000 руб" },
        { id: 3, name: "Программа тренировок", price: "3000 руб" },
      ];

      const sendMessage = () => {
        if (!chatInput.trim()) return;
        setChatMessages([...chatMessages, { id: Date.now(), sender: "trainer", text: chatInput }]);
        setChatInput("");
      };

      const handleAction = (action) => {
        setChatMessages([
          ...chatMessages,
          {
            id: Date.now(),
            sender: "agent",
            text: `Действие: ${action}`,
            actions: ["отправить клиенту", "изменить текст"],
          },
        ]);
      };

      const filteredClients = clients.filter((client) => {
        const matchesSearch = client.name.toLowerCase().includes(searchQuery.toLowerCase());
        const matchesStatus = statusFilter === "Все" || client.status === statusFilter;
        return matchesSearch && matchesStatus;
      });

      const handleTouchStart = (e) => {
        touchStartX.current = e.touches[0].clientX;
      };
      const handleTouchMove = (e) => {
        touchEndX.current = e.touches[0].clientX;
      };
      const handleTouchEnd = () => {
        if (!touchStartX.current || !touchEndX.current) return;
        const diff = touchStartX.current - touchEndX.current;
        if (Math.abs(diff) > 50) {
          if (diff > 0) {
            if (crmSubTab === "clients") setCrmSubTab("deals");
            else if (crmSubTab === "deals") setCrmSubTab("reports");
          } else {
            if (crmSubTab === "deals") setCrmSubTab("clients");
            else if (crmSubTab === "reports") setCrmSubTab("deals");
          }
        }
        touchStartX.current = 0;
        touchEndX.current = 0;
      };

      const handleClientTouchStart = (e) => {
        clientTouchStartX.current = e.touches[0].clientX;
      };
      const handleClientTouchMove = (e) => {
        clientTouchEndX.current = e.touches[0].clientX;
      };
      const handleClientTouchEnd = () => {
        if (!clientTouchStartX.current || !clientTouchEndX.current) return;
        const diff = clientTouchStartX.current - clientTouchEndX.current;
        if (Math.abs(diff) > 50) {
          if (diff > 0 && clientDetailIndex === 0) setClientDetailIndex(1);
          else if (diff < 0 && clientDetailIndex === 1) setClientDetailIndex(0);
        }
        clientTouchStartX.current = 0;
        clientTouchEndX.current = 0;
      };

      const DashboardScreen = () => {
        const filteredClientsDash = clients.filter(
          (c) => c.status === "Демо" || c.status === "Купил"
        );
        return (
          <div className="flex flex-col h-full bg-gray-50 pb-20">
            <div className="bg-white p-4 border-b border-gray-200 flex justify-between items-center">
              <h1 className="text-lg font-semibold text-gray-900">Сводка</h1>
              <button onClick={() => setActiveTab("agent")} className="text-blue-600 text-sm">
                Чат AI
              </button>
            </div>

            <div className="flex-1 overflow-y-auto p-4 space-y-4">
              <div className="grid grid-cols-2 gap-3">
                <div className="bg-white rounded-lg p-4 shadow-sm border border-gray-100">
                  <div className="flex items-center gap-2 mb-2">
                    <Users className="text-blue-600" />
                    <span className="text-sm text-gray-600">Клиенты</span>
                  </div>
                  <p className="text-2xl font-bold text-gray-900">24</p>
                  <p className="text-xs text-green-600">+2 за неделю</p>
                </div>

                <div className="bg-white rounded-lg p-4 shadow-sm border border-gray-100">
                  <div className="flex items-center gap-2 mb-2">
                    <Coins className="text-green-600" />
                    <span className="text-sm text-gray-600">Выручка</span>
                  </div>
                  <p className="text-2xl font-bold text-gray-900">125т</p>
                  <p className="text-xs text-green-600">+15% за месяц</p>
                </div>

                <div className="bg-white rounded-lg p-4 shadow-sm border border-gray-100">
                  <div className="flex items-center gap-2 mb-2">
                    <TrendingUp className="text-purple-600" />
                    <span className="text-sm text-gray-600">Продажи</span>
                  </div>
                  <p className="text-2xl font-bold text-gray-900">8</p>
                  <p className="text-xs text-green-600">+1 за неделю</p>
                </div>

                <div className="bg-white rounded-lg p-4 shadow-sm border border-gray-100">
                  <div className="flex items-center gap-2 mb-2">
                    <CalendarCheck className="text-orange-600" />
                    <span className="text-sm text-gray-600">Задачи</span>
                  </div>
                  <p className="text-2xl font-bold text-gray-900">15</p>
                  <p className="text-xs text-gray-500">на неделе</p>
                </div>
              </div>

              <div className="relative">
                <div className="flex space-x-4 overflow-x-auto pb-4 scrollbar-hide">
                  <div className="flex-shrink-0 w-[92%] bg-white rounded-lg p-4 shadow-sm border border-gray-100">
                    <div className="flex justify-between items-center mb-3">
                      <h3 className="font-medium text-gray-900">Ближайшие задачи</h3>
                      <button
                        className="text-blue-600 text-sm font-medium"
                        onClick={() => setActiveTab("agent")}
                      >
                        Все задачи
                      </button>
                    </div>
                    {tasks.slice(0, 3).map((task) => (
                      <div
                        key={task.id}
                        className="flex justify-between items-center py-2 border-b border-gray-100 last:border-b-0"
                      >
                        <div>
                          <p className="text-sm text-gray-800">{task.text}</p>
                          <p className="text-xs text-gray-500">{task.client}</p>
                        </div>
                        <span
                          className={`text-xs px-2 py-1 rounded ${
                            task.overdue ? "bg-red-100 text-red-800" : "bg-green-100 text-green-800"
                          }`}
                        >
                          {task.overdue ? "Просрочено" : task.date}
                        </span>
                      </div>
                    ))}
                  </div>

                  <div className="flex-shrink-0 w-[92%] bg-white rounded-lg p-4 shadow-sm border border-gray-100">
                    <div className="flex justify-between items-center mb-3">
                      <h3 className="font-medium text-gray-900">Клиенты на неделе</h3>
                    </div>
                    {filteredClientsDash.slice(0, 3).map((client) => (
                      <div
                        key={client.id}
                        className="flex justify-between items-center py-2 border-b border-gray-100 last:border-b-0"
                      >
                        <div className="flex-1">
                          <div className="flex justify-between items-center">
                            <p className="text-sm text-gray-800">{client.name}</p>
                            <div className="flex gap-2">
                              <span
                                className={`text-xs px-2 py-1 rounded ${
                                  client.status === "Купил"
                                    ? "bg-green-100 text-green-800"
                                    : client.status === "Демо"
                                    ? "bg-blue-100 text-blue-800"
                                    : "bg-gray-100 text-gray-800"
                                }`}
                              >
                                {client.day}
                              </span>
                              <span className="text-xs px-2 py-1 rounded bg-gray-100 text-gray-800">
                                {client.location}
                              </span>
                            </div>
                          </div>
                        </div>
                      </div>
                    ))}
                  </div>
                </div>
              </div>
            </div>
          </div>
        );
      };

      const AgentScreen = () => (
        <div className="flex flex-col h-full bg-gray-50 pb-20">
          <div className="bg-white p-4 border-b border-gray-200 flex justify-between items-center">
            <h1 className="text-lg font-semibold text-gray-900">ИИ-агент</h1>
            <button onClick={() => setActiveTab("dashboard")} className="text-gray-500">
              <X />
            </button>
          </div>

          <div className="flex-1 overflow-y-auto p-4 space-y-3">
            {chatMessages.map((msg) => (
              <div
                key={msg.id}
                className={`flex ${msg.sender === "trainer" ? "justify-end" : "justify-start"}`}
              >
                <div
                  className={`max-w-xs ${
                    msg.sender === "trainer" ? "bg-blue-600 text-white" : "bg-white text-gray-800"
                  } rounded-lg p-3 shadow-sm border ${msg.sender !== "trainer" ? "border-gray-200" : ""}`}
                >
                  <p className="text-sm">{msg.text}</p>
                  {msg.actions && (
                    <div className="mt-2 space-y-1">
                      {msg.actions.map((action, idx) => (
                        <button
                          key={idx}
                          onClick={() => handleAction(action)}
                          className={`block w-full text-left py-1 px-2 rounded text-xs ${
                            msg.sender === "trainer" ? "bg-blue-700" : "bg-gray-100"
                          } hover:opacity-80`}
                        >
                          {action}
                        </button>
                      ))}
                    </div>
                  )}
                </div>
              </div>
            ))}
          </div>

          <div className="p-4 space-y-2">
            <div className="flex gap-1 overflow-x-auto pb-2">
              {["дожим после демо", "напомнить оплату", "рассылка", "отчет за неделю"].map((cmd) => (
                <button
                  key={cmd}
                  onClick={() => handleAction(cmd)}
                  className="flex-shrink-0 bg-gray-100 text-gray-700 py-1 px-3 rounded-full text-xs whitespace-nowrap"
                >
                  {cmd}
                </button>
              ))}
            </div>

            <div className="flex gap-2">
              <button className="text-gray-500 p-2">
                <Paperclip />
              </button>
              <input
                type="text"
                value={chatInput}
                onChange={(e) => setChatInput(e.target.value)}
                onKeyDown={(e) => e.key === "Enter" && sendMessage()}
                placeholder="Сообщение агенту..."
                className="flex-1 border border-gray-300 rounded-lg px-3 py-2 text-sm"
              />
              <button onClick={sendMessage} className="bg-blue-600 text-white p-2 rounded-lg">
                <Send />
              </button>
            </div>
          </div>
        </div>
      );

      const CRMClientsTab = () => (
        <div className="flex flex-col h-full">
          <div className="p-4 space-y-3">
            <div className="relative">
              <div className="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400">
                <Search />
              </div>
              <input
                type="text"
                placeholder="Поиск клиентов..."
                value={searchQuery}
                onChange={(e) => setSearchQuery(e.target.value)}
                className="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg text-sm"
              />
            </div>

            <div className="flex gap-2 overflow-x-auto pb-2">
              {["Все", "Купил", "Думает", "Демо", "Новый"].map((filter) => (
                <button
                  key={filter}
                  onClick={() => setStatusFilter(filter)}
                  className={`flex-shrink-0 px-3 py-1 rounded-full text-xs whitespace-nowrap ${
                    statusFilter === filter
                      ? "bg-blue-600 text-white"
                      : filter === "Купил"
                      ? "bg-green-100 text-green-800"
                      : filter === "Думает"
                      ? "bg-yellow-100 text-yellow-800"
                      : filter === "Демо"
                      ? "bg-blue-100 text-blue-800"
                      : filter === "Новый"
                      ? "bg-purple-100 text-purple-800"
                      : "bg-gray-100 text-gray-700"
                  }`}
                >
                  {filter}
                </button>
              ))}
            </div>

            <div className="space-y-3">
              {filteredClients.length ? (
                filteredClients.map((client) => (
                  <div
                    key={client.id}
                    className="bg-white rounded-lg p-4 shadow-sm border border-gray-100"
                    onClick={() => {
                      setSelectedClient(client);
                      setActiveTab("client");
                    }}
                  >
                    <div className="flex justify-between items-start">
                      <div className="flex-1">
                        <div className="flex justify-between items-start mb-2">
                          <div className="relative">
                            <img src={client.avatar} alt={client.name} className="w-8 h-8 rounded-full" />
                            {client.premium && (
                              <div className="absolute -top-1 -right-1 bg-white rounded-full">
                                <i className="fa-solid fa-crown text-yellow-500 text-[10px]"></i>
                              </div>
                            )}
                          </div>
                          <div className="flex-1 ml-2">
                            <h3 className="font-medium text-gray-900">{client.name}</h3>
                          </div>
                          <span
                            className={`inline-block px-2 py-1 rounded-full text-xs font-medium ${
                              client.status === "Купил"
                                ? "bg-green-100 text-green-800"
                                : client.status === "Думает"
                                ? "bg-yellow-100 text-yellow-800"
                                : client.status === "Демо"
                                ? "bg-blue-100 text-blue-800"
                                : client.status === "Новый"
                                ? "bg-purple-100 text-purple-800"
                                : "bg-gray-100 text-gray-800"
                            }`}
                          >
                            {client.status}
                          </span>
                        </div>
                      </div>
                    </div>
                    <div className="flex justify-end gap-2 mt-2">
                      <button className="text-blue-600">
                        <MessageSquare className="text-[14px]" />
                      </button>
                      <button className="text-green-600">
                        <Phone className="text-[14px]" />
                      </button>
                    </div>
                  </div>
                ))
              ) : (
                <div className="text-center py-8">
                  <p className="text-gray-500">Клиенты не найдены</p>
                </div>
              )}
            </div>
          </div>
        </div>
      );

      const CRMDealsTab = () => (
        <div className="flex flex-col h-full">
          <div className="p-4 space-y-6">
            <div className="bg-white rounded-lg p-4 shadow-sm border border-gray-100">
              <h3 className="font-medium text-gray-900 mb-3">Воронки продаж</h3>
              <div className="space-y-3">
                <div className="flex justify-between items-center">
                  <span className="text-sm text-gray-600">Новые лиды</span>
                  <span className="text-sm font-medium text-gray-900">12</span>
                </div>
                <div className="flex justify-between items-center">
                  <span className="text-sm text-gray-600">На консультации</span>
                  <span className="text-sm font-medium text-gray-900">8</span>
                </div>
                <div className="flex justify-between items-center">
                  <span className="text-sm text-gray-600">Покупка</span>
                  <span className="text-sm font-medium text-gray-900">5</span>
                </div>
              </div>
            </div>

            <div className="bg-white rounded-lg p-4 shadow-sm border border-gray-100">
              <h3 className="font-medium text-gray-900 mb-3">Сегменты</h3>
              <div className="space-y-3">
                <div className="flex justify-between items-center">
                  <span className="text-sm text-gray-600">Новые клиенты</span>
                  <span className="text-sm font-medium text-gray-900">8</span>
                </div>
                <div className="flex justify-between items-center">
                  <span className="text-sm text-gray-600">Повторные</span>
                  <span className="text-sm font-medium text-gray-900">16</span>
                </div>
                <div className="flex justify-between items-center">
                  <span className="text-sm text-gray-600">VIP-клиенты</span>
                  <span className="text-sm font-medium text-gray-900">4</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      );

      const CRMReportsTab = () => (
        <div className="flex flex-col h-full">
          <div className="p-4 space-y-6">
            <div className="grid grid-cols-3 gap-3">
              <div className="border border-gray-200 rounded-lg p-3 text-center bg-blue-50">
                <Mail className="text-blue-600 text-[20px] mx-auto mb-1" />
                <p className="text-xs text-gray-600">Активные рассылки</p>
                <p className="text-lg font-bold text-gray-900">3</p>
              </div>
              <div className="border border-gray-200 rounded-lg p-3 text-center bg-green-50">
                <Eye className="text-green-600 text-[20px] mx-auto mb-1" />
                <p className="text-xs text-gray-600">Открытие</p>
                <p className="text-lg font-bold text-gray-900">65%</p>
              </div>
              <div className="border border-gray-200 rounded-lg p-3 text-center bg-purple-50">
                <TrendingUpIcon className="text-purple-600 text-[20px] mx-auto mb-1" />
                <p className="text-xs text-gray-600">Конверсия</p>
                <p className="text-lg font-bold text-gray-900">12%</p>
              </div>
            </div>

            <div className="bg-white rounded-lg p-4 shadow-sm border border-gray-100">
              <h3 className="font-medium text-gray-900 mb-3">Метрики (KPI)</h3>
              <div className="space-y-3">
                <div className="flex justify-between items-center">
                  <span className="text-sm text-gray-600">Средний чек</span>
                  <span className="text-sm font-medium text-gray-900">8т</span>
                </div>
                <div className="flex justify-between items-center">
                  <span className="text-sm text-gray-600">LTV</span>
                  <span className="text-sm font-medium text-gray-900">32т</span>
                </div>
              </div>
            </div>

            <div className="bg-white rounded-lg p-4 shadow-sm border border-gray-100">
              <h3 className="font-medium text-gray-900 mb-3">Каналы</h3>
              <div className="space-y-3">
                <div className="flex justify-between items-center">
                  <span className="text-sm text-gray-600">Instagram</span>
                  <span className="text-sm font-medium text-gray-900">45%</span>
                </div>
                <div className="flex justify-between items-center">
                  <span className="text-sm text-gray-600">Рекомендации</span>
                  <span className="text-sm font-medium text-gray-900">30%</span>
                </div>
                <div className="flex justify-between items-center">
                  <span className="text-sm text-gray-600">Реклама</span>
                  <span className="text-sm font-medium text-gray-900">25%</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      );

      const CRMScreen = () => (
        <div
          className="flex flex-col h-full bg-gray-50 pb-20"
          onTouchStart={handleTouchStart}
          onTouchMove={handleTouchMove}
          onTouchEnd={handleTouchEnd}
        >
          <div className="bg-white p-4 border-b border-gray-200 flex justify-between items-center">
            <h1 className="text-lg font-semibold text-gray-900">CRM</h1>
            <div className="flex items-center gap-2">
              <button className="bg-blue-600 text-white p-2 rounded-lg">
                <Plus />
              </button>
              <button onClick={() => setActiveTab("agent")} className="text-blue-600 text-sm">
                Чат AI
              </button>
            </div>
          </div>

          <div className="flex gap-1 mt-3 px-4">
            {["clients", "deals", "reports"].map((tab) => (
              <button
                key={tab}
                onClick={() => setCrmSubTab(tab)}
                className={`flex-1 py-2 px-3 rounded-lg text-sm font-medium ${
                  crmSubTab === tab ? "bg-blue-600 text-white" : "bg-gray-100 text-gray-700"
                }`}
              >
                {tab === "clients" ? "Клиенты" : tab === "deals" ? "Сделки" : "Рассылки"}
              </button>
            ))}
          </div>

          <div className="flex-1 overflow-y-auto">
            {crmSubTab === "clients" && <CRMClientsTab />}
            {crmSubTab === "deals" && <CRMDealsTab />}
            {crmSubTab === "reports" && <CRMReportsTab />}
          </div>
        </div>
      );

      const ClientDetailScreen = () => {
        if (!selectedClient) return <CRMScreen />;

        return (
          <div className="flex flex-col h-full bg-gray-50 pb-20">
            <div className="bg-white p-4 border-b border-gray-200 flex justify-between items-center">
              <h1 className="text-lg font-semibold text-gray-900">Детали клиента</h1>
              <button className="text-gray-500" onClick={() => setActiveTab("crm")}>
                <X />
              </button>
            </div>

            <div className="flex justify-center py-3 bg-white border-b border-gray-200">
              <div className="flex space-x-6">
                <button
                  onClick={() => setClientDetailIndex(0)}
                  className={`text-sm font-medium pb-2 ${
                    clientDetailIndex === 0 ? "text-blue-600 border-b-2 border-blue-600" : "text-gray-500"
                  }`}
                >
                  Инфо
                </button>
                <button
                  onClick={() => setClientDetailIndex(1)}
                  className={`text-sm font-medium pb-2 ${
                    clientDetailIndex === 1 ? "text-blue-600 border-b-2 border-blue-600" : "text-gray-500"
                  }`}
                >
                  Активности
                </button>
              </div>
            </div>

            <div
              className="flex-1 overflow-y-auto p-4 space-y-6"
              onTouchStart={handleClientTouchStart}
              onTouchMove={handleClientTouchMove}
              onTouchEnd={handleClientTouchEnd}
            >
              {clientDetailIndex === 0 && (
                <>
                  <div className="bg-white rounded-xl p-4 shadow-sm border border-gray-100">
                    <h3 className="font-medium text-gray-900 mb-3">Контактная информация</h3>
                    <div className="space-y-3">
                      <div className="flex justify-between items-center">
                        <span className="text-gray-500">Телефон</span>
                        <div className="flex items-center gap-2">
                          <Phone className="text-gray-400" />
                          <span className="text-gray-900">{selectedClient.phone}</span>
                        </div>
                      </div>
                      <div className="flex justify-between items-center">
                        <span className="text-gray-500">Email</span>
                        <div className="flex items-center gap-2">
                          <MailIcon className="text-gray-400" />
                          <span className="text-gray-900">{selectedClient.email}</span>
                        </div>
                      </div>
                      <div className="flex justify-between items-center">
                        <span className="text-gray-500">Возраст</span>
                        <div className="flex items-center gap-2">
                          <UserIcon className="text-gray-400" />
                          <span className="text-gray-900">{selectedClient.age} лет</span>
                        </div>
                      </div>
                      <div className="flex justify-between items-center">
                        <span className="text-gray-500">Местоположение</span>
                        <div className="flex items-center gap-2">
                          <MapPin className="text-gray-400" />
                          <span className="text-gray-900">{selectedClient.location}</span>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div className="bg-white rounded-xl p-4 shadow-sm border border-gray-100">
                    <h3 className="font-medium text-gray-900 mb-3">История</h3>
                    <div className="space-y-3">
                      {selectedClient.history.map((item, i) => (
                        <div key={i} className="border-b border-gray-100 pb-3 last:border-b-0 last:pb-0">
                          <p className="text-sm text-gray-800">{item.message}</p>
                          <div className="flex justify-between items-center mt-1">
                            <span className="text-xs text-gray-500">{item.date}</span>
                            <span className="text-xs text-gray-400">{item.sender}</span>
                          </div>
                        </div>
                      ))}
                    </div>
                  </div>
                </>
              )}

              {clientDetailIndex === 1 && (
                <>
                  <div className="bg-white rounded-xl p-4 shadow-sm border border-gray-100">
                    <h3 className="font-medium text-gray-900 mb-4">Физическая активность</h3>
                    <div className="grid grid-cols-2 gap-4">
                      <div className="border border-gray-200 rounded-lg p-3 text-center">
                        <div className="text-2xl font-bold text-gray-900">{selectedClient.activity.calories}</div>
                        <p className="text-sm text-gray-600">Калории</p>
                      </div>
                      <div className="border border-gray-200 rounded-lg p-3 text-center">
                        <div className="text-2xl font-bold text-gray-900">{selectedClient.activity.steps}</div>
                        <p className="text-sm text-gray-600">Шаги</p>
                      </div>
                      <div className="border border-gray-200 rounded-lg p-3 text-center">
                        <div className="text-2xl font-bold text-gray-900">{selectedClient.activity.water}л</div>
                        <p className="text-sm text-gray-600">Вода</p>
                      </div>
                      <div className="border border-gray-200 rounded-lg p-3 text-center">
                        <div className="text-2xl font-bold text-gray-900">{selectedClient.activity.workouts}</div>
                        <p className="text-sm text-gray-600">Тренировки</p>
                      </div>
                      <div className="border border-gray-200 rounded-lg p-3 text-center col-span-2">
                        <div className="text-2xl font-bold text-gray-900">{selectedClient.activity.sleep}ч</div>
                        <p className="text-sm text-gray-600">Сон</p>
                      </div>
                    </div>
                  </div>

                  <div className="bg-white rounded-xl p-4 shadow-sm border border-gray-100">
                    <h3 className="font-medium text-gray-900 mb-3">Статистика за неделю</h3>
                    <div className="space-y-3">
                      <div className="flex justify-between items-center">
                        <span className="text-gray-700">Средние шаги</span>
                        <span className="text-gray-900">7800/день</span>
                      </div>
                      <div className="flex justify-between items-center">
                        <span className="text-gray-700">Средние калории</span>
                        <span className="text-gray-900">2100/день</span>
                      </div>
                      <div className="flex justify-between items-center">
                        <span className="text-gray-700">Активные дни</span>
                        <span className="text-gray-900">5/7</span>
                      </div>
                    </div>
                  </div>

                  <div className="bg-white rounded-xl p-4 shadow-sm border border-gray-100">
                    <h3 className="font-medium text-gray-900 mb-3">Продукты и услуги</h3>
                    <div className="space-y-3">
                      {selectedClient.purchasedProducts.length ? (
                        selectedClient.purchasedProducts.map((product, i) => (
                          <div key={i} className="flex items-center justify-between">
                            <div className="flex items-center gap-3">
                              <div className="p-2 bg-blue-100 rounded-lg">
                                <Check className="text-blue-600" />
                              </div>
                              <span className="text-gray-700">{product}</span>
                            </div>
                          </div>
                        ))
                      ) : (
                        <p className="text-gray-500 text-center py-4">Нет приобретенных продуктов</p>
                      )}
                    </div>
                  </div>
                </>
              )}

              <div className="flex justify-between items-center">
                <button className="p-3 bg-gray-100 rounded-full text-gray-600 hover:bg-gray-200 transition-colors">
                  <MoreVertical />
                </button>
                <button className="flex-1 bg-gradient-to-r from-blue-600 to-purple-600 text-white py-3 px-6 rounded-xl font-medium flex items-center justify-center gap-2 ml-3">
                  <MessageCircle />
                  Сообщение
                </button>
              </div>
            </div>
          </div>
        );
      };

      const ProfileScreen = () => (
        <div className="flex flex-col h-full bg-gray-50 pb-20">
          <div className="bg-white p-4 border-b border-gray-200">
            <h1 className="text-lg font-semibold text-gray-900">Профиль</h1>
          </div>

          <div className="flex-1 overflow-y-auto p-4 space-y-3">
            <div className="bg-white rounded-lg p-4 shadow-sm border border-gray-100">
              <h3 className="font-medium text-gray-900 mb-3 flex items-center gap-2">
                <UserIcon className="text-[16px]" />
                О тренере
              </h3>
              <div className="space-y-2">
                <div>
                  <p className="text-sm text-gray-600">Имя</p>
                  <p className="text-sm font-medium text-gray-900">Иван Иванов</p>
                </div>
                <div>
                  <p className="text-sm text-gray-600">Стаж</p>
                  <p className="text-sm font-medium text-gray-900">5 лет</p>
                </div>
                <div>
                  <p className="text-sm text-gray-600">Специализация</p>
                  <p className="text-sm font-medium text-gray-900">Персональный тренинг, питание</p>
                </div>
                <div>
                  <p className="text-sm text-gray-600">Контакт</p>
                  <p className="text-sm font-medium text-gray-900">+7 (999) 123-45-67</p>
                </div>
              </div>
            </div>

            <div className="bg-white rounded-lg p-4 shadow-sm border border-gray-100">
              <h3 className="font-medium text-gray-900 mb-3 flex items-center gap-2">
                <Archive className="text-[16px]" />
                Настройки CRM
              </h3>
              <div className="space-y-3">
                <div className="border border-gray-200 rounded-lg p-3">
                  <h4 className="font-medium text-gray-900 mb-2">Продукты и услуги</h4>
                  <div className="text-sm text-gray-600 space-y-1">
                    {products.map((p) => (
                      <p key={p.id}>
                        {p.name} — {p.price}
                      </p>
                    ))}
                  </div>
                </div>
                <div className="border border-gray-200 rounded-lg p-3">
                  <h4 className="font-medium text-gray-900 mb-2">Шаблоны документов</h4>
                  <div className="text-sm text-gray-600 space-y-1">
                    <p>• Договор оказания услуг</p>
                    <p>• Счет на оплату</p>
                    <p>• Шаблоны сообщений клиенту</p>
                  </div>
                </div>
              </div>
            </div>

            <div className="bg-white rounded-lg p-4 shadow-sm border border-gray-100">
              <h3 className="font-medium text-gray-900 mb-3 flex items-center gap-2">
                <LinkIcon className="text-[16px]" />
                Интеграции
              </h3>
              <div className="space-y-3">
                <div className="border border-gray-200 rounded-lg p-3">
                  <h4 className="font-medium text-gray-900 mb-2 flex items-center gap-2">
                    <Watch className="text-[16px]" />
                    Garmin
                  </h4>
                  <p className="text-sm text-gray-600">Интеграция с Garmin устройствами</p>
                </div>
                <div className="border border-gray-200 rounded-lg p-3">
                  <h4 className="font-medium text-gray-900 mb-2 flex items-center gap-2">
                    <Smartphone className="text-[16px]" />
                    Apple Watch
                  </h4>
                  <p className="text-sm text-gray-600">Интеграция с Apple Watch</p>
                </div>
                <div className="border border-gray-200 rounded-lg p-3">
                  <h4 className="font-medium text-gray-900 mb-2 flex items-center gap-2">
                    <Bot className="text-[16px]" />
                    Чат-боты
                  </h4>
                  <p className="text-sm text-gray-600">Интеграция с Telegram и WhatsApp ботами</p>
                </div>
                <div className="border border-gray-200 rounded-lg p-3">
                  <h4 className="font-medium text-gray-900 mb-2 flex items-center gap-2">
                    <Globe className="text-[16px]" />
                    Соцсети
                  </h4>
                  <p className="text-sm text-gray-600">Instagram, VK, Telegram</p>
                </div>
              </div>
            </div>

            <div className="bg-white rounded-lg p-4 shadow-sm border border-gray-100">
              <h3 className="font-medium text-gray-900 mb-3 flex items-center gap-2">
                <Settings className="text-[16px]" />
                О приложении
              </h3>
              <div className="space-y-3">
                <button className="w-full text-left text-sm text-gray-700 py-2 border-b border-gray-100">
                  Условия пользования
                </button>
                <button className="w-full text-left text-sm text-gray-700 py-2 border-b border-gray-100">
                  Политика конфиденциальности
                </button>
                <button className="w-full text-left text-sm text-gray-700 py-2">
                  Справочный центр
                </button>
              </div>
            </div>

            <div className="text-center text-xs text-gray-500 mt-4">
              <p>Ai может ошибаться — проверяйте информацию.</p>
            </div>
          </div>
        </div>
      );

      const renderScreen = () => {
        switch (activeTab) {
          case "dashboard":
            return <DashboardScreen />;
          case "agent":
            return <AgentScreen />;
          case "crm":
            return <CRMScreen />;
          case "client":
            return <ClientDetailScreen />;
          case "profile":
            return <ProfileScreen />;
          default:
            return <DashboardScreen />;
        }
      };

      return (
        <div className="w-full h-screen max-w-sm mx-auto bg-white flex flex-col relative">
          {renderScreen()}

          <div className="bg-white border-t border-gray-200 px-4 py-2 fixed bottom-0 left-1/2 transform -translate-x-1/2 w-full max-w-sm z-10">
            <div className="flex justify-around">
              {[
                { key: "dashboard", icon: BarChart3, label: "Сводка" },
                { key: "crm", icon: Users, label: "CRM" },
                { key: "profile", icon: Settings, label: "Профиль" },
              ].map((tab) => (
                <button
                  key={tab.key}
                  onClick={() => setActiveTab(tab.key)}
                  className={`flex flex-col items-center py-2 px-3 ${
                    activeTab === tab.key ? "text-blue-600" : "text-gray-500"
                  }`}
                >
                  <tab.icon />
                  <span className="text-xs mt-1">{tab.label}</span>
                </button>
              ))}
            </div>
          </div>
        </div>
      );
    };

    const root = ReactDOM.createRoot(document.getElementById("root"));
    root.render(<App />);
  </script>
</body>
</html>

